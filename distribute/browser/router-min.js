"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=_interopRequireDefault(require("./Events/index")),_index2=_interopRequireDefault(require("./Channels/index")),_index3=_interopRequireDefault(require("./Utils/index")),_index4=_interopRequireDefault(require("./Service/index")),_index5=_interopRequireDefault(require("./Model/index")),_index6=_interopRequireDefault(require("./View/index")),_index7=_interopRequireDefault(require("./Controller/index")),_index8=_interopRequireDefault(require("./Router/index"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var MVC={Events:_index.default,Channels:_index2.default,Utils:_index3.default,Service:_index4.default,Model:_index5.default,View:_index6.default,Controller:_index7.default,Router:_index8.default},_default=MVC;exports.default=_default,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Events=class{constructor(){}get _events(){return this.events=this.events||{},this.events}getEventCallbacks(e){return this._events[e]||{}}getEventCallbackName(e){return e.name.length?e.name:"anonymousFunction"}getEventCallbackGroup(e,t){return e[t]||[]}on(e,t){var r=this.getEventCallbacks(e),n=this.getEventCallbackName(t),i=this.getEventCallbackGroup(r,n);return i.push(t),r[n]=i,this._events[e]=r,this}off(){switch(arguments.length){case 0:delete this.events;break;case 1:var e=arguments[0];delete this._events[e];break;case 2:e=arguments[0];var t=arguments[1],r="string"==typeof t?t:this.getEventCallbackName(t);this._events[e]&&(delete this._events[e][r],0===Object.keys(this._events[e]).length&&delete this._events[e])}return this}emit(e,t){var r=Object.values(arguments),n=Object.entries(this.getEventCallbacks(e));for(var[i,s]of n)for(var o of s){o(t,...r.splice(2)||[])}return this}};_default=Events;exports.default=_default,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;_index=_interopRequireDefault(require("../Utils/index")),_index2=_interopRequireDefault(require("../Base/index"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var Router=class extends _index2.default{constructor(){return super(...arguments),this}get protocol(){return window.location.protocol}get hostname(){return window.location.hostname}get port(){return window.location.port}get path(){return window.location.pathname}get hash(){var e=window.location.href,t=e.indexOf("#");if(t>-1){var r,n=e.indexOf("?"),i=t+1;return r=n>-1?t>n?e.length:n:e.length,(e=e.slice(i,r)).length?e:null}return null}get params(){var e=window.location.href,t=e.indexOf("?");if(t>-1){var r,n=e.indexOf("#"),i=t+1;return r=n>-1?t>n?e.length:n:e.length,(e=e.slice(i,r)).length?e:null}return null}get _routeData(){var e={location:{},controller:{}},t=this.path.split("/").filter(e=>e.length);t=t.length?t:["/"];var r=this.hash,n=r?r.split("/").filter(e=>e.length):null,i=this.params,s=i?_index.default.paramsToObject(i):null;this.protocol&&(e.location.protocol=this.protocol),this.hostname&&(e.location.hostname=this.hostname),this.port&&(e.location.port=this.port),this.path&&(e.location.path=this.path),r&&n&&(n=n.length?n:["/"],e.location.hash={path:r,fragments:n}),i&&s&&(e.location.params={path:i,data:s}),e.location.path={name:this.path,fragments:t},e.location.currentURL=this.currentURL;var o=this._routeControllerData;return e.location=Object.assign(e.location,o.location),e.controller=o.controller,this.routeData=e,this.routeData}get _routeControllerData(){var e={location:{}};return Object.entries(this.routes).forEach(t=>{var[r,n]=t,i=this.path.split("/").filter(e=>e.length);i=i.length?i:["/"];var s,o=r.split("/").filter((e,t)=>e.length);if(o=o.length?o:["/"],i.length&&i.length===o.length)return o.filter((t,l)=>{if(void 0===s||!0===s){if(":"===t[0]){var a=t.replace(":","");l===i.length-1&&(e.location.currentIDKey=a),e.location[a]=i[l],t=this.fragmentIDRegExp}else t=t.replace(new RegExp("/","gi"),"\\/"),t=this.routeFragmentNameRegExp(t);if(!0===(s=t.test(i[l]))&&l===i.length-1)return e.location.route={name:r,fragments:o},e.controller=n,n}})[0]}),e}get _enabled(){return this.enabled||!1}set _enabled(e){this.enabled=e}get _routes(){return this.routes=this.routes||{},this.routes}set _routes(e){this.routes=_index.default.addPropertiesToObject(e,this._routes)}get _controller(){return this.controller}set _controller(e){this.controller=e}get _previousURL(){return this.previousURL}set _previousURL(e){this.previousURL=e}get _currentURL(){return this.currentURL}set _currentURL(e){this.currentURL&&(this._previousURL=this.currentURL),this.currentURL=e}get fragmentIDRegExp(){return new RegExp(/^([0-9A-Z\?\=\,\.\*\-\_\'\"\^\%\$\#\@\!\~\(\)\{\}\&\<\>\\\/])*$/,"gi")}routeFragmentNameRegExp(e){return new RegExp("^".concat(e,"$"))}enable(){return this.enabled||(this.enableEvents(),this.enableRoutes(),this._enabled=!0),this}disable(){return this.enabled&&(this.disableEvents(),this.disableRoutes(),this._enabled=!1),this}enableRoutes(){return this.settings.controller&&(this._controller=this.settings.controller),this._routes=Object.entries(this.settings.routes).reduce((e,t,r,n)=>{var[i,s]=t;return e[i]=Object.assign(s,{callback:this.controller[s.callback].bind(this.controller)}),e},{}),this}disableRoutes(){return delete this._routes,delete this._controller,this}enableEvents(){return window.addEventListener("hashchange",this.routeChange.bind(this)),this}disableEvents(){return window.removeEventListener("hashchange",this.routeChange.bind(this)),this}routeChange(){this._currentURL=window.location.href;var e=this._routeData;return e.controller&&(this.previousURL&&(e.previousURL=this.previousURL),this.emit("navigate",e),e.controller.callback(e)),this}navigate(e){window.location.href=e}};_default=Router;exports.default=_default;