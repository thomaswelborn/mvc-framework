"use strict";var MVC=MVC||{};MVC.Events=class{constructor(){}get _events(){return this.events=this.events||{},this.events}getEventCallbacks(t){return this._events[t]||{}}getEventCallbackName(t){return t.name.length?t.name:"anonymousFunction"}getEventCallbackGroup(t,e){return t[e]||[]}on(t,e){var r=this.getEventCallbacks(t),n=this.getEventCallbackName(e),s=this.getEventCallbackGroup(r,n);return s.push(e),r[n]=s,this._events[t]=r,this}off(){switch(arguments.length){case 0:delete this.events;break;case 1:var t=arguments[0];delete this._events[t];break;case 2:t=arguments[0];var e=arguments[1],r="string"==typeof e?e:this.getEventCallbackName(e);this._events[t]&&(delete this._events[t][r],0===Object.keys(this._events[t]).length&&delete this._events[t])}return this}emit(t,e){var r=Object.values(arguments),n=Object.entries(this.getEventCallbacks(t));for(var[s,i]of n)for(var o of i){o(e,...r.splice(2)||[])}return this}},MVC.Router=class extends MVC.Base{constructor(){return super(...arguments),this}get protocol(){return window.location.protocol}get hostname(){return window.location.hostname}get port(){return window.location.port}get path(){return window.location.pathname}get hash(){var t=window.location.href,e=t.indexOf("#");if(e>-1){var r,n=t.indexOf("?"),s=e+1;return r=n>-1?e>n?t.length:n:t.length,(t=t.slice(s,r)).length?t:null}return null}get params(){var t=window.location.href,e=t.indexOf("?");if(e>-1){var r,n=t.indexOf("#"),s=e+1;return r=n>-1?e>n?t.length:n:t.length,(t=t.slice(s,r)).length?t:null}return null}get _routeData(){var t={location:{},controller:{}},e=this.path.split("/").filter(t=>t.length);e=e.length?e:["/"];var r=this.hash,n=r?r.split("/").filter(t=>t.length):null,s=this.params,i=s?MVC.Utils.paramsToObject(s):null;this.protocol&&(t.location.protocol=this.protocol),this.hostname&&(t.location.hostname=this.hostname),this.port&&(t.location.port=this.port),this.path&&(t.location.path=this.path),r&&n&&(n=n.length?n:["/"],t.location.hash={path:r,fragments:n}),s&&i&&(t.location.params={path:s,data:i}),t.location.path={name:this.path,fragments:e},t.location.currentURL=this.currentURL;var o=this._routeControllerData;return t.location=Object.assign(t.location,o.location),t.controller=o.controller,this.routeData=t,this.routeData}get _routeControllerData(){var t={location:{}};return Object.entries(this.routes).forEach(e=>{var[r,n]=e,s=this.path.split("/").filter(t=>t.length);s=s.length?s:["/"];var i,o=r.split("/").filter((t,e)=>t.length);if(o=o.length?o:["/"],s.length&&s.length===o.length)return o.filter((e,a)=>{if(void 0===i||!0===i){if(":"===e[0]){var l=e.replace(":","");a===s.length-1&&(t.location.currentIDKey=l),t.location[l]=s[a],e=this.fragmentIDRegExp}else e=e.replace(new RegExp("/","gi"),"\\/"),e=this.routeFragmentNameRegExp(e);if(!0===(i=e.test(s[a]))&&a===s.length-1)return t.location.route={name:r,fragments:o},t.controller=n,n}})[0]}),t}get _enabled(){return this.enabled||!1}set _enabled(t){this.enabled=t}get _routes(){return this.routes=this.routes||{},this.routes}set _routes(t){this.routes=MVC.Utils.addPropertiesToObject(t,this._routes)}get _controller(){return this.controller}set _controller(t){this.controller=t}get _previousURL(){return this.previousURL}set _previousURL(t){this.previousURL=t}get _currentURL(){return this.currentURL}set _currentURL(t){this.currentURL&&(this._previousURL=this.currentURL),this.currentURL=t}get fragmentIDRegExp(){return new RegExp(/^([0-9A-Z\?\=\,\.\*\-\_\'\"\^\%\$\#\@\!\~\(\)\{\}\&\<\>\\\/])*$/,"gi")}routeFragmentNameRegExp(t){return new RegExp("^".concat(t,"$"))}enable(){return this.enabled||(this.enableEvents(),this.enableRoutes(),this._enabled=!0),this}disable(){return this.enabled&&(this.disableEvents(),this.disableRoutes(),this._enabled=!1),this}enableRoutes(){return this.settings.controller&&(this._controller=this.settings.controller),this._routes=Object.entries(this.settings.routes).reduce((t,e,r,n)=>{var[s,i]=e;return t[s]=Object.assign(i,{callback:this.controller[i.callback].bind(this.controller)}),t},{}),this}disableRoutes(){return delete this._routes,delete this._controller,this}enableEvents(){return window.addEventListener("hashchange",this.routeChange.bind(this)),this}disableEvents(){return window.removeEventListener("hashchange",this.routeChange.bind(this)),this}routeChange(){this._currentURL=window.location.href;var t=this._routeData;return t.controller&&(this.previousURL&&(t.previousURL=this.previousURL),this.emit("navigate",t),t.controller.callback(t)),this}navigate(t){window.location.href=t}};