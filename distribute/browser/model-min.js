"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=_interopRequireDefault(require("./Events/index")),_index2=_interopRequireDefault(require("./Channels/index")),_index3=_interopRequireDefault(require("./Utils/index")),_index4=_interopRequireDefault(require("./Service/index")),_index5=_interopRequireDefault(require("./Model/index")),_index6=_interopRequireDefault(require("./View/index")),_index7=_interopRequireDefault(require("./Controller/index")),_index8=_interopRequireDefault(require("./Router/index"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var MVC={Events:_index.default,Channels:_index2.default,Utils:_index3.default,Service:_index4.default,Model:_index5.default,View:_index6.default,Controller:_index7.default,Router:_index8.default},_default=MVC;exports.default=_default,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Events=class{constructor(){}get _events(){return this.events=this.events||{},this.events}getEventCallbacks(e){return this._events[e]||{}}getEventCallbackName(e){return e.name.length?e.name:"anonymousFunction"}getEventCallbackGroup(e,t){return e[t]||[]}on(e,t){var s=this.getEventCallbacks(e),a=this.getEventCallbackName(t),i=this.getEventCallbackGroup(s,a);return i.push(t),s[a]=i,this._events[e]=s,this}off(){switch(arguments.length){case 0:delete this.events;break;case 1:var e=arguments[0];delete this._events[e];break;case 2:e=arguments[0];var t=arguments[1],s="string"==typeof t?t:this.getEventCallbackName(t);this._events[e]&&(delete this._events[e][s],0===Object.keys(this._events[e]).length&&delete this._events[e])}return this}emit(e,t){var s=Object.values(arguments),a=Object.entries(this.getEventCallbacks(e));for(var[i,r]of a)for(var n of r){n(t,...s.splice(2)||[])}return this}};_default=Events;exports.default=_default,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;_index=_interopRequireDefault(require("../Utils/index")),_index2=_interopRequireDefault(require("../Base/index"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var Model=class extends _index2.default{constructor(){return super(...arguments),this}get keyMap(){return["name","schema","localStorage","histiogram","services","serviceCallbacks","serviceEvents","data","dataCallbacks","dataEvents","defaults"]}get _schema(){return this._schema}set _schema(e){this.schema=e}get _isSetting(){return this.isSetting}set _isSetting(e){this.isSetting=e}get _changing(){return this.changing=this.changing||{},this.changing}get _localStorage(){return this.localStorage}set _localStorage(e){this.localStorage=e}get _defaults(){return this.defaults}set _defaults(e){this.defaults=e}get _histiogram(){return this.histiogram||{length:1}}set _histiogram(e){this.histiogram=Object.assign(this._histiogram,e)}get _history(){return this.history=this.history||[],this.history}set _history(e){Object.keys(e).length&&this._histiogram.length&&(this._history.unshift(this.parse(e)),this._history.splice(this._histiogram.length))}get _db(){var e=localStorage.getItem(this.localStorage.endpoint);return this.db=e||"{}",JSON.parse(this.db)}set _db(e){e=JSON.stringify(e),localStorage.setItem(this.localStorage.endpoint,e)}get _data(){return this.data=this.data||{},this.data}get _dataEvents(){return this.dataEvents=this.dataEvents||{},this.dataEvents}set _dataEvents(e){this.dataEvents=_index.default.addPropertiesToObject(e,this._dataEvents)}get _dataCallbacks(){return this.dataCallbacks=this.dataCallbacks||{},this.dataCallbacks}set _dataCallbacks(e){this.dataCallbacks=_index.default.addPropertiesToObject(e,this._dataCallbacks)}get _services(){return this.services=this.services||{},this.services}set _services(e){this.services=_index.default.addPropertiesToObject(e,this._services)}get _serviceEvents(){return this.serviceEvents=this.serviceEvents||{},this.serviceEvents}set _serviceEvents(e){this.serviceEvents=_index.default.addPropertiesToObject(e,this._serviceEvents)}get _serviceCallbacks(){return this.serviceCallbacks=this.serviceCallbacks||{},this.serviceCallbacks}set _serviceCallbacks(e){this.serviceCallbacks=_index.default.addPropertiesToObject(e,this._serviceCallbacks)}get _enabled(){return this.enabled||!1}set _enabled(e){this.enabled=e}get(){switch(arguments.length){case 0:return this._data;case 1:var e=arguments[0];return this._data[e]}}set(){switch(this._history=this.parse(),arguments.length){case 1:this._isSetting=!0;var e=Object.entries(arguments[0]);e.forEach((t,s)=>{var[a,i]=t;s===e.length-1&&(this._isSetting=!1),this.setDataProperty(a,i)});break;case 2:var t=arguments[0],s=arguments[1];this.setDataProperty(t,s)}return this}unset(){switch(this._history=this.parse(),arguments.length){case 0:for(var e of Object.keys(this._data))this.unsetDataProperty(e);break;case 1:var t=arguments[0];this.unsetDataProperty(t)}return this}setDB(){var e=this._db;switch(arguments.length){case 1:Object.entries(arguments[0]).forEach(t=>{var[s,a]=t;e[s]=a});break;case 2:var t=arguments[0],s=arguments[1];e[t]=s}return this._db=e,this}unsetDB(){switch(arguments.length){case 0:delete this._db;break;case 1:var e=this._db;delete e[arguments[0]],this._db=e}return this}setDataProperty(e,t){if(!this._data["_".concat(e)]){var s=this;Object.defineProperties(this._data,{["_".concat(e)]:{configurable:!0,get(){return this[e]},set(t){var a=s._settings.schema;a&&a[e]?(this[e]=t,s._changing[e]=t,this.localStorage&&s.setDB(e,t)):a||(this[e]=t,s._changing[e]=t,this.localStorage&&s.setDB(e,t));var i=["set",":",e].join("");s.emit(i,{name:i,data:{key:e,value:t}},s),s._isSetting||(Object.values(s._changing).length?s.emit("set",{name:"set",data:Object.assign({},s._changing,s._data)},s):s.emit("set",{name:"set",data:s._data},s),delete s.changing)}}})}return this._data["_".concat(e)]=t,this}unsetDataProperty(e){var t=["unset",":",e].join(""),s=this._data[e];return delete this._data["_".concat(e)],delete this._data[e],this.emit(t,{name:t,data:{key:e,value:s}},this),this.emit("unset",{name:"unset",data:{key:e,value:s}},this),this}setDefaults(){var e={};this.defaults&&Object.assign(e,this.defaults),this.localStorage&&Object.assign(e,this._db),Object.keys(e)&&this.set(e)}resetServiceEvents(){return this.disableServiceEvents().enableServiceEvents()}enableServiceEvents(){this.services&&this.serviceEvents&&this.serviceCallbacks&&_index.default.bindEventsToTargetObjects(this.serviceEvents,this.services,this.serviceCallbacks)}disableServiceEvents(){this.services&&this.serviceEvents&&this.serviceCallbacks&&_index.default.unbindEventsFromTargetObjects(this.serviceEvents,this.services,this.serviceCallbacks)}resetDataEvents(){return this.disableDataEvents().enableDataEvents()}enableDataEvents(){this.dataEvents&&this.dataCallbacks&&_index.default.bindEventsToTargetObjects(this.dataEvents,this,this.dataCallbacks)}disableDataEvents(){this.dataEvents&&this.dataCallbacks,_index.default.unbindEventsFromTargetObjects(this.dataEvents,this,this.dataCallbacks)}enable(){var e=this.settings;return this.enabled||(this.setProperties(e||{},this.keyMap,{data:function(e){this.set(e)}.bind(this)}),this.enableServiceEvents(),this.enableDataEvents(),this._enabled=!0),this}disable(){var e=this.settings;return this.enabled&&(this.disableServiceEvents(),this.disableDataEvents(),this.deleteProperties(e||{},this.keyMap),this._enabled=!1),this}parse(e){return e=e||this._data||{},JSON.parse(JSON.stringify(e))}};_default=Model;exports.default=_default;